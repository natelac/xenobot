#!/bin/bash
# xenobot

# TODO:
# - Check that python3 exists and that it is python3.8, if not ry running python3.8
# directly

pipe=tmp/botpipe

usage() {
  echo "Usage: $0 (start [-g guild -p db_path] | gather [-g guild -p db_path | stop)"
}

check_pipe() {
  if [[ ! -p $pipe ]]; then
    echo "Could not find pipe: $pipe"
    exit 1
  fi
}

function main(){
  if [[ ${#} == 0 ]]; then
    main_usage;
  fi

  case ${1} in
    start)
      ${1};
      ;;
    gather | stop)
      $check_pipe
      ${1} "${@:2}";
      ;;
    *)
      echo $main_usage;
      exit 1;
      ;;
  esac
}

function start(){
  python3.8 bot.py "$@"
}

function gather(){
  echo "$@" >$pipe
  python3.8 gather.py "$@"
}

function stop(){
  echo "$@" 
  echo "stop not implemented"
}
  
main "$@";
exit 0
